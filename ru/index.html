<?php
require_once __DIR__ . '/../ping.php';          // –æ—Ç–º–µ—Ç–∏—Ç—å—Å—è –æ–Ω–ª–∞–π–Ω
require_once __DIR__ . '/../online_count.php';  // —Ñ—É–Ω–∫—Ü–∏—è –ø–æ–¥—Å—á—ë—Ç–∞
?>

<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>–ü—Ä–æ—Ñ—Å–æ—é–∑ –ø–æ–ª–∏—Ü–µ–π—Å–∫–∏—Ö –∏ –¥—Ä—É–≥–∏–µ –ø–∞—Ä—Ç–Ω—ë—Ä—Å–∫–∏–µ –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏–∏ ‚Äì biedriem.lv</title>
  <meta name="description"
        content="Neatkarƒ´gƒÅ policistu arodbiedrƒ´ba ‚Äî –ø—Ä–æ—Ñ—Å–æ—é–∑ –ø–æ–ª–∏—Ü–µ–π—Å–∫–∏—Ö –õ–∞—Ç–≤–∏–∏. Biedriem.lv ‚Äî –æ–±—â–∞—è –ø–ª–∞—Ç—Ñ–æ—Ä–º–∞ –ø—Ä–æ—Ñ—Å–æ—é–∑–æ–≤ –ø–æ–ª–∏—Ü–µ–π—Å–∫–∏—Ö, IT-—Å–ø–µ—Ü–∏–∞–ª–∏—Å—Ç–æ–≤ –∏ —é—Ä–∏—Å—Ç–æ–≤.">

  <link rel="stylesheet" href="../css/style.css">

  <style>
    .news-ticker {
      background: #123b82;
      color: white;
      padding: 10px 0;
      overflow: hidden;
      white-space: nowrap;
      font-size: 18px;
      font-weight: 500;
      cursor: pointer;
      margin-top: 20px;
      margin-bottom: 4px;
      position: relative;
    }

    .news-track {
      display: inline-block;
      will-change: transform;
      transform: translateX(0);
      transition: transform 0.08s linear;
      padding-left: 100%;
    }

    .org-title {
      text-align: center !important;
      width: 100%;
      display: block;
      font-size: 1.3rem;
      line-height: 1.4;
      padding: 10px 5px;
      word-wrap: break-word;
      overflow-wrap: break-word;
    }

    @media (max-width: 600px) {
      .org-title {
        font-size: 1.5rem;
        padding: 15px 8px;
      }
    }
  </style>
</head>

<body>
  <header class="home-header">
    <h1>–ù–µ–∑–∞–≤–∏—Å–∏–º—ã–π –ø—Ä–æ—Ñ—Å–æ—é–∑ –ø–æ–ª–∏—Ü–µ–π—Å–∫–∏—Ö –∏ –ø–∞—Ä—Ç–Ω—ë—Ä—Å–∫–∏–µ –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏–∏</h1>
          <div class="lang-switch">
    <span>–Ø–∑—ã–∫:</span>
    <a href="../index.html">LV</a> |
    <a href="index.html" class="active">RU</a> |
    <a href="../en/index.html">EN</a> | 
    <a href="../de/index.html">DE</a> 
  </div>
    <p>
      Biedriem.lv ‚Äî –ø–ª–∞—Ç—Ñ–æ—Ä–º–∞, –æ–±—ä–µ–¥–∏–Ω—è—é—â–∞—è –ø—Ä–æ—Ñ—Å–æ—é–∑ –ø–æ–ª–∏—Ü–µ–π—Å–∫–∏—Ö, –ø—Ä–æ—Ñ—Å–æ—é–∑ —Å–ø–µ—Ü–∏–∞–ª–∏—Å—Ç–æ–≤ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–æ–Ω–Ω—ã—Ö
      —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏–π –∏ –õ–∞—Ç–≤–∏–π—Å–∫—É—é –∞—Å—Å–æ—Ü–∏–∞—Ü–∏—é —é—Ä–∏—Å—Ç–æ–≤.
    </p>


  </header>

  
  <div class="news-ticker" aria-label="–õ–µ–Ω—Ç–∞ –Ω–æ–≤–æ—Å—Ç–µ–π LSM –∏ –ø–æ—Ä—Ç–∞–ª–∞ LV ‚Äî –≤–µ—Ä—Ö–Ω—è—è">
    <span class="news-track" id="newsTickerTop">
      –ó–∞–≥—Ä—É–∂–∞—é—Ç—Å—è –Ω–æ–≤–æ—Å—Ç–∏...
    </span>
  </div>

  <main class="home-main">
    <div class="org-list">

  <div class="org-tile">
    <a class="org-text" href="../ru/npa/index.html">
      <span class="org-title">–ù–µ–∑–∞–≤–∏—Å–∏–º—ã–π –ø—Ä–æ—Ñ—Å–æ—é–∑ –ø–æ–ª–∏—Ü–µ–π—Å–∫–∏—Ö ‚Äî –ø—Ä–æ—Ñ—Å–æ—é–∑ –ø–æ–ª–∏—Ü–µ–π—Å–∫–∏—Ö –õ–∞—Ç–≤–∏–∏</span>
    </a>

    <a class="org-logo-link" href="../img/NPA Logo.png" target="_blank" rel="noopener">
      <picture class="org-logo-wrap">
        <source srcset="../img/NPA Logo.webp" type="image/webp">
        <img class="org-logo" src="../img/NPA Logo.png" alt="–õ–æ–≥–æ—Ç–∏–ø NPA">
      </picture>
    </a>
  </div>

  <div class="org-tile">
    <a class="org-text" href="../ru/itsa/index.html">
      <span class="org-title">–ü—Ä–æ—Ñ—Å–æ—é–∑ —Å–ø–µ—Ü–∏–∞–ª–∏—Å—Ç–æ–≤ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–æ–Ω–Ω—ã—Ö —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏–π</span>
    </a>

    <a class="org-logo-link" href="../img/ITSA Logo.png" target="_blank" rel="noopener">
      <picture class="org-logo-wrap">
        <source srcset="../img/ITSA Logo.webp" type="image/webp">
        <img class="org-logo" src="../img/ITSA Logo.png" alt="–õ–æ–≥–æ—Ç–∏–ø ITSA">
      </picture>
    </a>
  </div>

  <div class="org-tile">
    <a class="org-text" href="../ru/lja/index.html">
      <span class="org-title">–û–±—ä–µ–¥–∏–Ω–µ–Ω–∏–µ –ª–∞—Ç–≤–∏–π—Å–∫–∏—Ö —é—Ä–∏—Å—Ç–æ–≤</span>
    </a>

    <a class="org-logo-link" href="../img/LJA Logo.png" target="_blank" rel="noopener">
      <picture class="org-logo-wrap">
        <source srcset="../img/LJA Logo.webp" type="image/webp">
        <img class="org-logo" src="../img/LJA Logo.png" alt="–õ–æ–≥–æ—Ç–∏–ø LJA">
      </picture>
    </a>
  </div>

</div>

<div class="news-ticker" aria-label="LSM un LV portƒÅla zi≈Üu lente ‚Äì apak≈°ƒÅ">
  <span class="news-track" id="newsTickerBottom">IelƒÅdƒì zi≈Üas...</span>
</div>

<section class="greeting" aria-label="Ziemassvƒìtku un JaunƒÅ gada novƒìlƒìjums">
  <div class="greeting-card">
    <div class="greeting-media">
      <img src="../img/V.Skrastina_Ziemassvetku_foto.png"
           alt="Ziemassvƒìtku un JaunƒÅ gada novƒìlƒìjums ‚Äì svƒìtku foto"
           loading="lazy">
    </div>

    <div class="greeting-text">
      <section class="greeting-block" aria-label="–ü–æ–∑–¥—Ä–∞–≤–ª–µ–Ω–∏–µ —Å –†–æ–∂–¥–µ—Å—Ç–≤–æ–º –∏ –ù–æ–≤—ã–º –≥–æ–¥–æ–º">
  <h2>üéÑ –†–æ–∂–¥–µ—Å—Ç–≤–µ–Ω—Å–∫–æ–µ –∏ –Ω–æ–≤–æ–≥–æ–¥–Ω–µ–µ –ø–æ–∑–¥—Ä–∞–≤–ª–µ–Ω–∏–µ</h2>

  <p><strong>–£–≤–∞–∂–∞–µ–º—ã–µ —á–ª–µ–Ω—ã –ø—Ä–æ—Ñ—Å–æ—é–∑–∞, –∫–æ–ª–ª–µ–≥–∏ –∏ –ø–∞—Ä—Ç–Ω—ë—Ä—ã,</strong></p>

  <p>
    –í —Ä–æ–∂–¥–µ—Å—Ç–≤–µ–Ω—Å–∫–∏–µ –¥–Ω–∏ –∂–µ–ª–∞–µ–º –º–∏—Ä–∞, –¥—É—à–µ–≤–Ω–æ–≥–æ —Ç–µ–ø–ª–∞ –∏ —á—É–≤—Å—Ç–≤–∞ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ –≤ –≤–∞—à–∏—Ö —Å–µ–º—å—è—Ö,
    –∞ –≤ –ù–æ–≤–æ–º –≥–æ–¥—É ‚Äî —Å–∏–ª, –ø—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω–æ–π —É–≤–µ—Ä–µ–Ω–Ω–æ—Å—Ç–∏ –∏ —Å–ø—Ä–∞–≤–µ–¥–ª–∏–≤—ã—Ö —É—Å–ª–æ–≤–∏–π —Ç—Ä—É–¥–∞.
  </p>

  <p>
    –ü—É—Å—Ç—å 2026 –≥–æ–¥ –ø—Ä–∏–Ω–µ—Å—ë—Ç —è—Å–Ω—ã–µ —Ü–µ–ª–∏, —Å–ø–ª–æ—á—ë–Ω–Ω–æ—Å—Ç—å –∏ –≤–∑–∞–∏–º–Ω–æ–µ —É–≤–∞–∂–µ–Ω–∏–µ,
    —É–∫—Ä–µ–ø–ª—è—è –∫–∞–∫ –∫–∞–∂–¥–æ–≥–æ –∏–∑ –Ω–∞—Å –ø–æ –æ—Ç–¥–µ–ª—å–Ω–æ—Å—Ç–∏, —Ç–∞–∫ –∏ –Ω–∞—à–∏ –æ–±—â–∏–µ —Ü–µ–Ω–Ω–æ—Å—Ç–∏.
  </p>

  <p>
    <strong>–° –±–ª–∞–≥–æ–¥–∞—Ä–Ω–æ—Å—Ç—å—é –∑–∞ –¥–æ–≤–µ—Ä–∏–µ –∏ —Å–æ—Ç—Ä—É–¥–Ω–∏—á–µ—Å—Ç–≤–æ,</strong><br>
    –í–∞—à–∏ –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏–∏ ‚Äî biedriem.lv
  </p>
</section>
    </div>
  </div>
</section>

  </main>

  <footer>
    <p>&copy; 2008‚Äì2025 Biedriem.lv ‚Äî –ø—Ä–æ—Ñ—Å–æ—é–∑ –ø–æ–ª–∏—Ü–µ–π—Å–∫–∏—Ö –∏ –ø–∞—Ä—Ç–Ω—ë—Ä—Å–∫–∏–µ –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏–∏</p>
  </footer>

  <script>

    const RSS_LSM       = "https://api.rss2json.com/v1/api.json?rss_url=https://www.lsm.lv/rss/?lang=lv";
    const RSS_LVPORTALS = "https://api.rss2json.com/v1/api.json?rss_url=https://lvportals.lv/rss";

    const topTrack    = document.getElementById('newsTickerTop');
    const bottomTrack = document.getElementById('newsTickerBottom');

    const speed  = 55;  
    const stepMs = 40;

    function makeTicker(trackElement, containerElement) {
      let offset      = 0;
      let playing     = true;
      let dragging    = false;
      let dragStartX  = 0;
      let offsetStart = 0;

      function tick() {
        if (!playing || dragging) return;
        offset -= (speed * stepMs) / 1000;
        const trackWidth = trackElement.offsetWidth;
        if (-offset > trackWidth) {
          offset = 0;
        }
        trackElement.style.transform = `translateX(${offset}px)`;
      }

      setInterval(tick, stepMs);

      containerElement.addEventListener('mouseenter', () => {
        playing = false;
      });

      containerElement.addEventListener('mouseleave', () => {
        if (!dragging) playing = true;
      });

      containerElement.addEventListener('mousedown', (e) => {
        dragging = true;
        playing = false;
        dragStartX = e.clientX;
        offsetStart = offset;
      });

      window.addEventListener('mousemove', (e) => {
        if (!dragging) return;
        const dx = e.clientX - dragStartX;
        offset = offsetStart + dx;
        trackElement.style.transform = `translateX(${offset}px)`;
      });

      window.addEventListener('mouseup', () => {
        if (!dragging) return;
        dragging = false;
        playing = true;
      });
    }

    function extractTitles(data, max = 6) {
      if (!data || !data.items) return [];
      return data.items.slice(0, max).map(item => item.title);
    }

    Promise.all([
      fetch(RSS_LSM).then(r => r.json()).catch(() => null),
      fetch(RSS_LVPORTALS).then(r => r.json()).catch(() => null)
    ]).then(([lsmData, lvData]) => {
      const lsmTitles = extractTitles(lsmData, 6);
      const lvTitles  = extractTitles(lvData, 6);

      let allTitles = [];
      allTitles = allTitles
        .concat(lsmTitles.map(t => "üì∞ " + t))
        .concat(lvTitles.map(t => "‚öñÔ∏è " + t));

      const text = allTitles.length
        ? allTitles.join(" ‚Ä¢ ")
        : "–ù–µ—Ç –¥–æ—Å—Ç—É–ø–Ω—ã—Ö –Ω–æ–≤–æ—Å—Ç–µ–π LSM –∏–ª–∏ –ø–æ—Ä—Ç–∞–ª–∞ LV.";

      const finalText = allTitles.length ? text + " ‚Ä¢ " + text : text;

      topTrack.textContent    = finalText;
      bottomTrack.textContent = finalText;

      makeTicker(topTrack,    topTrack.parentElement);
      makeTicker(bottomTrack, bottomTrack.parentElement);
    }).catch(() => {
      const fallback = "–ù–µ —É–¥–∞–ª–æ—Å—å –∑–∞–≥—Ä—É–∑–∏—Ç—å —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ –Ω–æ–≤–æ—Å—Ç–Ω–æ–π –ª–µ–Ω—Ç—ã.";
      topTrack.textContent    = fallback;
      bottomTrack.textContent = fallback;
    });
  let tabId = sessionStorage.getItem('tabId');
  if (!tabId) {
    tabId = (crypto.randomUUID ? crypto.randomUUID() : String(Date.now()) + Math.random());
    sessionStorage.setItem('tabId', tabId);
  }

  fetch('/ping.php?tab=' + encodeURIComponent(tabId), { cache: 'no-store' }).catch(()=>{});

  fetch('/online.php', { cache: 'no-store' })
    .then(r => r.text())
    .then(n => {
      const el = document.getElementById('onlineCount');
      if (el) el.textContent = n;
    })
    .catch(()=>{});
  </script>
</body>
</html>

